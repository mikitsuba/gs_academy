<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<script src="js/jquery-2.1.3.min.js"></script>
<link rel="stylesheet" href="css/sample.css">
<title>じゃんけん & 30ゲーム</title>
</head>
<body>

<header>
  <h1 class="janken-title">じゃんけん & 30ゲーム</h1>
</header>

<main>
  <section id="janken">
    <div class="wrapper janken-wrapper">
      <h2 class="small-title">じゃんけん</h2>
      <ul>
        <li id="rock_btn">グー</li>
        <li id="scissors_btn">チョキ</li>
        <li id="paper_btn">パー</li>
      </ul>
      <div class="janken-result">
        <div>コンピュータの出した手は？「<span id="pc_hands">なに？</span>」</div>
        <div>勝敗結果は・・・<span id="judgment"></span></div>
      </div>
    </div>
  </section>

  <section id="30-game">
    <div class="wrapper 30-game-wrapper">
      <h2 class="small-title">30ゲーム</h2>
      <div class="balloon-container">
        <div class="balloon-instruction">
          <p class="instruction" id="turn-message">1ターンに3つまで数字を選んで、<span>OK!</span>を押してね！</p>
        </div>
      </div>
      <div class="turn-box">
        <p class="turn"><span id="turn">あなた</span>の番</p>
        <span id="ok-btn">OK!</span>
      </div>
      <table class="numbers">
        <tr>
          <td class="number" id="number1">1</td>
          <td class="number" id="number2">2</td>
          <td class="number" id="number3">3</td>
          <td class="number" id="number4">4</td>
          <td class="number" id="number5">5</td>
          <td class="number" id="number6">6</td>
          <td class="number" id="number7">7</td>
          <td class="number" id="number8">8</td>
          <td class="number" id="number9">9</td>
          <td class="number" id="number10">10</td>
        </tr>
        <tr>
          <td class="number" id="number11">11</td>
          <td class="number" id="number12">12</td>
          <td class="number" id="number13">13</td>
          <td class="number" id="number14">14</td>
          <td class="number" id="number15">15</td>
          <td class="number" id="number16">16</td>
          <td class="number" id="number17">17</td>
          <td class="number" id="number18">18</td>
          <td class="number" id="number19">19</td>
          <td class="number" id="number20">20</td>
        </tr>
        <tr>
          <td class="number" id="number21">21</td>
          <td class="number" id="number22">22</td>
          <td class="number" id="number23">23</td>
          <td class="number" id="number24">24</td>
          <td class="number" id="number25">25</td>
          <td class="number" id="number26">26</td>
          <td class="number" id="number27">27</td>
          <td class="number" id="number28">28</td>
          <td class="number" id="number29">29</td>
          <td class="number" id="number30">30</td>
        </tr>
      </table>
      <div class="result-box">
        <p class="result">あなたの勝ち</p>
      </div>
    </div>
  </section>

</main>

<footer></footer>
<script>
//じゃんけん用のSCRIPT
  let pc_hands = '';
  let user_hands = '';

  function pc_hand_roulette(){
    const rand_num = Math.ceil(Math.random() * 3);
    if(rand_num == 1){
      pc_hands = 'グー！';
    } else if(rand_num == 2){
      pc_hands = 'チョキ！';
    } else {
      pc_hands = 'パー！';
    }
    $('#pc_hands').text(pc_hands);
  }

  function janken_judgment(){
    if(pc_hands == user_hands){
      $('#judgment').text('あいこ！（もう1回出す手を選んで）');
    } else if (pc_hands == 'グー！' && user_hands == 'チョキ！'){
      $('#judgment').text('あなたの負け！');
    } else if (pc_hands == 'グー！' && user_hands == 'パー！'){
      $('#judgment').text('あなたの勝ち！');
    } else if (pc_hands == 'チョキ！' && user_hands == 'パー！'){
      $('#judgment').text('あなたの負け！');
    } else if (pc_hands == 'チョキ！' && user_hands == 'グー！'){
      $('#judgment').text('あなたの勝ち！');
    } else if (pc_hands == 'パー！' && user_hands == 'グー！'){
      $('#judgment').text('あなたの負け！');
    } else if (pc_hands == 'パー！' && user_hands == 'チョキ！'){
      $('#judgment').text('あなたの勝ち！');
    }
  }

  $('#rock_btn').on('click', function(){
    user_hands = 'グー！'
    pc_hand_roulette();
    janken_judgment();
  })

  $('#scissors_btn').on('click', function(){
    user_hands = 'チョキ！'
    pc_hand_roulette();
    janken_judgment();
  })

  $('#paper_btn').on('click', function(){
    user_hands = 'パー！'
    pc_hand_roulette();
    janken_judgment();
  })

// 30ゲーム用のscript

//ターンの変更（自ターンのときのみ、数字を押せる）
  //ターンの表示
  let player_turn = true; // ターンを定義。trueがplayerでfalseがcom。デフォルトはplayer
  
  function turn_change(){
    if(player_turn){
      $('#turn').text('あなた');
    } else {
      $('#turn').text('COM');
      $('#turn-message').text('ちょっと待ってね！');
      $('#ok-btn').hide();
    }
  }

  //自ターンに押した数字を、押した認定する（選択された数字が、連番で3つ以内でなければならない）

  let button_num = 0; // 選択された数字
  let button_status_array = [true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true]; //選択された数字の状態

  // playerのターンで、相手がすでに選択した数字からの距離が3以内である場合に、数字を選択することができる。また、playerのターン内であれば、もう一度クリックすることにより、選択を解除することができる
  function player_click(button){
    button_num = $(button).attr('id');
    button_num = Number(button_num.substr(6));

    if(player_turn && button_status_array[button_num - 1] == 'tentative'){
      $('#number' + button_num).css('background-color', '');
      $('#number' + button_num).css('color', '');
      button_status_array[button_num - 1] = true;
    } else if(player_turn && button_status_array[button_num - 1] && (button_num <= 3 || !button_status_array[button_num - 4])){
      $('#number' + button_num).css('background-color', 'pink');
      $('#number' + button_num).css('color', 'gray');
      button_status_array[button_num - 1] = 'tentative';
    } else if(player_turn) {
      alert('1回のターンで選択できる数字は3つ以内の連番のみです');
    } else {
      alert('COMのターンです。ちょっと待ってね！')
    }
    // playerのターンに、まだ選択されていない数字を選択した場合に、数字を選択する
    
  }

  $('td.number').on('click', function(){
    player_click(this);
  })

  $('#ok-btn').on('click', function(){
    // # TODO: そのターンに何も選択されていない場合、OKを押せないようにする
    player_turn = false;
    turn_change()
  })
  //もう1回押したらtrueに戻す

  //OKを押したらターンを変更（OKは連番を条件にする）


//comの選択
  //2秒程度待つ
  //必勝法のアルゴリズム
  //選択された数字をグレーに
  //選択された数字を青ハイライトに

//選択されたボタンはグレーに
  if(!button_status_array[button_num]){
    
  }

//勝敗の判定
  
  
</script>
</body>
</html>
